<div class="register">
	<div class="logo">
		<img src="/images/join_logo/join_logo_dark.svg" alt="" />
	</div>

	<div class="content">
		<div class="register-window">
			<div class="header">
				<a class="back-arrow" routerLink="/login">
					<!-- Inline SVG for Back Arrow (replaces /images/assets/arrow_left_line.svg) -->
					<svg
						xmlns="http://www.w3.org/2000/svg"
						width="24"
						height="24"
						viewBox="0 0 24 24"
						fill="none"
						stroke="currentColor"
						stroke-width="2"
						stroke-linecap="round"
						stroke-linejoin="round"
						class="lucide lucide-arrow-left"
					>
						<path d="m12 19-7-7 7-7" />
						<path d="M19 12H5" />
					</svg>
				</a>
				<div class="title-block">
					<h1>Sign up</h1>
					<div class="seperator"></div>
				</div>
			</div>

			<!-- FORMULAR-BINDUNG MIT REACTIVE FORMS -->
			<form [formGroup]="signupForm" (ngSubmit)="onSignUp()">
				<div class="inputs">
					<div
						class="input-wrapper"
						[class.hide-icon]="(signupForm.get('name')?.value ?? '').length > 2"
					>
						<!-- Inline SVG for Person Icon (replaces /images/sign_up_section/person_icon.svg) -->
						<img
							src="images/sign_up_section/person_icon.svg"
							alt="Person Icon"
							class="input-icon"
						/>
						<!-- Bindung zu Reactive Form Control: name -->
						<input type="text" placeholder="Name" formControlName="name" />
						@if (
							signupForm.get("name")?.invalid &&
							(signupForm.get("name")?.dirty || signupForm.get("name")?.touched)
						) {
							<div class="error-message">Name is required (min. 3 characters).</div>
						}
					</div>

					<div
						class="input-wrapper"
						[class.hide-icon]="(signupForm.get('email')?.value ?? '').length > 4"
					>
						<!-- Inline SVG for Mail Icon (replaces /images/login_section/mail_icon.svg) -->
						<img src="images/sign_up_section/mail_icon.svg" alt="Email Icon" class="input-icon" />

						<input type="text" placeholder="Email" formControlName="email" />

						@if (
							signupForm.get("email")?.hasError("required") &&
							(signupForm.get("email")?.dirty || signupForm.get("email")?.touched)
						) {
							<div class="error-message">Email is required.</div>
						}
						@if (
							signupForm.get("email")?.hasError("email") &&
							(signupForm.get("email")?.dirty || signupForm.get("email")?.touched)
						) {
							<div class="error-message">Please enter a valid email address.</div>
						}
					</div>

					<div
						class="input-wrapper"
						[class.hide-icon]="(signupForm.get('password')?.value ?? '').length > 8"
					>
						<!-- Inline SVG for Lock Icon (replaces /images/login_section/lock.svg) -->
						<img src="images/sign_up_section/lock.svg" alt="Lock Icon" class="input-icon" />

						<input type="password" placeholder="Password" formControlName="password" />

						@if (
							signupForm.get("password")?.hasError("minlength") &&
							(signupForm.get("password")?.dirty || signupForm.get("password")?.touched)
						) {
							<div class="error-message">The password must be at least 8 characters long.</div>
						}
					</div>

					<div
						class="input-wrapper"
						[class.hide-icon]="(signupForm.get('confirmPassword')?.value ?? '').length > 8"
					>
						<!-- Inline SVG for Lock Icon (replaces /images/login_section/lock.svg) -->
						<img src="images/sign_up_section/lock.svg" alt="Lock Icon" class="input-icon" />

						<input
							type="password"
							placeholder="Confirm Password"
							formControlName="confirmPassword"
						/>

						@if (
							signupForm.errors?.["passwordMismatch"] &&
							(signupForm.get("confirmPassword")?.dirty ||
								signupForm.get("confirmPassword")?.touched)
						) {
							<div class="error-message">Passwords do not match</div>
						}
					</div>
				</div>

				<div class="signup">
					<label class="checkbox-label">
						<input type="checkbox" formControlName="acceptedPolicy" />
						<span> I accept the <a routerLink="/privacy-policy">Privacy Policy</a>. </span>
					</label>
					@if (
						signupForm.get("acceptedPolicy")?.hasError("required") &&
						(signupForm.get("acceptedPolicy")?.dirty || signupForm.get("acceptedPolicy")?.touched)
					) {
						<div class="error-message text-center" style="margin-top: 8px">
							You must accept the privacy policy.
						</div>
					}

					<button
						type="submit"
						class="signup-button"
						[disabled]="signupForm.invalid || isLoading"
						[class.inactive-text]="signupForm.invalid"
					>
						<!-- Ladezustand anzeigen -->
						{{ isLoading ? "Registriere..." : "Sign up" }}
					</button>

					@if (errorMessage) {
						<div class="general-error-message">
							{{ errorMessage }}
						</div>
					}
				</div>
			</form>
		</div>

		<div class="legal-notes">
			<a routerLink="/privacy-policy">Privacy Policy</a>
			<a routerLink="/legal-notice">Legal Notice</a>
		</div>
	</div>
</div>
